machine:
  ruby:
    version: 2.2.2
  services:
    - docker

checkout:
  post:
    - git submodule sync
    - git submodule update --init

dependencies:
  pre:
    - gem install bundler --version '~> 1.9.9'
  post:
    - docker pull redis:2.8.19
    - docker pull rabbitmq:3.4.4-management
    - docker pull hectcastro/riak:latest

test:
  override:
    - bundle exec rake spec
        environment:
          DOCKER_HOST: unix:///var/run/docker.sock
